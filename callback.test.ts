// ë¹„ë™ê¸° í…ŒìŠ¤íŠ¸ë„ ë‹¹ì—°íˆ ê°€ëŠ¥í•¨.
// Callback / Promise / Async-Awiat ì „ë¶€ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥.

// ì½”ë“œê°€ ë³µì¡í•˜ê¸´ í•˜ì§€ë§Œ, íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ì—°ìŠµí•˜ê¸°ì— ì¢‹ì„ ê²ƒì„.
// Callback í…ŒìŠ¤íŠ¸
// setTimeoutì„ ì‚¬ìš©í•˜ì—¬ 2ì´ˆ ìˆë‹¤ê°€ íŠ¹ì • ì´ë¦„ì„ ë¦¬í„´í•˜ëŠ” í•¨ìˆ˜ë¥¼ í…ŒìŠ¤íŠ¸í•˜ëŠ” ì¼€ì´ìŠ¤ ë§Œë“¤ì–´ë³´ê¸°

// íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ê°€ ì½”ë“œ ê°€ë…ì„±ì€ ë–¨ì–´ì§. ì¥ë‹¨ì ì´ ìˆìŒ.
// const getNameCB = (callback: (str: string) => void): void => {
//   // ë¦¬í„´ ê°’ì€ ì—†ê³ , ì¸ìê°’ìœ¼ë¡œ ê°’ì„ ì „ë‹¬í•œë‹¤ëŠ” ëœ».
//   //   const getNameCB = (callback) => ì‚¬ì‹¤ìƒ ì´ ì½”ë“œì¸ë° íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ë¡œ í•´ì¤Œ.
//   //   ì²˜ìŒì—ëŠ” ë°›ì•„ë“¤ì´ë‹¤ê°€ í•˜ë‚˜í•˜ë‚˜ ì´í•´í•˜ëŠ”ê²Œ ì¢‹ì„ ê²ƒ!
//   const name: string = "Sangah";
//   setTimeout(() => {
//     callback(name);
//   }, 2000);
// };

// getUserInfo(
//   cb((name) => {
//     console.log(name);
//   }));
// ì´ê²ƒê³¼ ë¹„ìŠ·í•œ ê°œë…

// test("2ì´ˆ ë’¤ì— ì´ë¦„ì„ ë°›ì•„ì˜¤ëŠ” callBack í•¨ìˆ˜ í…ŒìŠ¤íŠ¸", () => {
//   getNameCB(callback); // í˜¸ì´ìŠ¤íŒ… ì§€ì›í•¨

//   function callback(name: string): void {
//     expect(name).toBe("ì‹ ìƒì•„");
//   }
// });

// âˆš 2ì´ˆ ë’¤ì— ì´ë¦„ì„ ë°›ì•„ì˜¤ëŠ” callBack í•¨ìˆ˜ í…ŒìŠ¤íŠ¸ (1 ms)
// 1msë¡œ 2ì´ˆë¥¼ ì •í™•í•˜ê²Œ ì°íˆì§€ ì•Šì•˜ë‹¤.

// "ì‹ ìƒì•„" í•œê¸€ ì´ë¦„ìœ¼ë¡œ í–ˆëŠ”ë° íŒ¨ìŠ¤ëœ ì²™ í•˜ë‹¤ê°€
// 2ì´ˆ ë’¤ì— ì—ëŸ¬ê°€ ëœ¸.

// ----------------------------------------------------------------

// ì½œë°± ë‚´ë¶€ì—ì„œ ê¸°ë‹¤ë¦¬ë„ë¡ ì²˜ë¦¬í•´ì£¼ëŠ” í•¨ìˆ˜ ì²˜ë¦¬. done.
// ì½œë°±ì„ ê¸°ë‹¤ë ¸ë‹¤ê°€ ì •í™•í•˜ê²Œ ì²˜ë¦¬í•´ì¤Œ.

// test("2ì´ˆ ë’¤ì— ì´ë¦„ì„ ë°›ì•„ì˜¤ëŠ” callBack í•¨ìˆ˜ í…ŒìŠ¤íŠ¸", (done) => {
//   function callback(name: string): void {
//     expect(name).toBe("Sangah");
//     done();
//   }

//   getNameCB(callback);
// });

// ----------------------------------------------------------------

// ì˜¤ëŠ˜ ì¤€ë¹„í•´ì˜¨ ê²ƒì¤‘ì— íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ì ìœ¼ë¡œ ê°€ì¥ ë¹¡ì„¼ ì½”ë“œ ğŸ‘‡ğŸ»
// ê³¨ì¹˜ê°€ ì•„í”„ê³ , ì •ì‹ ì´ ì—†ê² ì§€ë§Œ, íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ ê³µë¶€í•œë‹¤ëŠ” ì˜ë¯¸ì—ì„œ í•´ë³´ê¸°.

const getNameCB = (callback: (str: string) => void): void => {
  const name: string = "Sangah";
  setTimeout(() => {
    // 2ë¶„ì˜ 1 í™•ë¥ ë¡œ ì—ëŸ¬ë¥¼ ë°œìƒì‹œì¼œì„œ ì—ëŸ¬ê°€ ë°œìƒí•˜ë©´
    // callback í•¨ìˆ˜ì— ë‹´ì•„ì„œ ì „ë‹¬í•˜ëŠ” ì½”ë“œ
    try {
      if (Math.floor(Math.random() * 2) % 2 === 0) {
        // í™•ë¥ ë¡œ ì—ëŸ¬ë¥¼ ë°œìƒì‹œì¼œì•¼ ë˜ë‹ˆê¹Œ ì´ìƒí•˜ê²Œ ì§  ì½”ë“œë¼, ë¬´ì‹œí•´ë„ ë˜ëŠ” ì½”ë“œì„.
        console.log("ì •ìƒ ì¼€ì´ìŠ¤");
        callback(name);
      } else {
        console.log("ì—ëŸ¬ ì¼€ì´ìŠ¤");
        throw new Error("ì—ëŸ¬");
      }
    } catch (error) {
      callback(error);
    }
    // ì½œë°±ì˜ ì¸ìë¡œì¨ ì—ëŸ¬ë¥¼ ì „ë‹¬, ì£½ì§€ ì•Šê³  ì—ëŸ¬ë¥¼ ë˜ì§€ë ¤ë©´ try catchë¬¸ìœ¼ë¡œ ê°ì‹¸ì¤˜ì•¼ í•¨.
  }, 2000);
};

// ê±°ì˜ ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ try catch ì–´ë–»ê²Œ ì“°ëŠ”ì§€ ë³´ëŠ” ìš©ë„ì„.
// ê·¸ë¦¬ê³  JESTë¡œ í™•ì¸í•˜ëŠ” ê²ƒì„.

test("2ì´ˆ ë’¤ì— ì´ë¦„ì„ ë°›ì•„ì˜¤ëŠ” callBack í•¨ìˆ˜ í…ŒìŠ¤íŠ¸", (done) => {
  // dataë¡œ 'ì—ëŸ¬'ê°€ ë“¤ì–´ì˜¬ì§€, 'ë°ì´í„°'ê°€ ë“¤ì–´ì˜¬ì§€ ëª¨ë¥´ë¯€ë¡œ any íƒ€ì… ì„¤ì •
  function callback(data: any): void {
    try {
      if (data instanceof Error) {
        // â†‘ ë°ì´í„°ê°€ Error ë¼ëŠ” í˜•íƒœë¥¼ ê°€ì¡ŒëŠ”ì§€ í™•ì¸
        expect(data.message).toBe("ì—ëŸ¬");
      } else {
        expect(data).toBe("Sangah");
      }
      done();
    } catch (error) {
      done(error);
    }
  }
  getNameCB(callback);
});

// ì—ëŸ¬ ì¼€ì´ìŠ¤ / ì •ìƒ ì¼€ì´ìŠ¤ ë²ˆê°ˆì•„ ë§‰ ëœ¬ë‹¤.
// ê¸°ë‹¤ë ¸ë‹¤ê°€ ê°’ì´ ì˜ ë“¤ì–´ì˜¤ëŠ” ì •ë„ë¡œ done ì˜ ê¸°ì–µí•˜ë©´ ëœë‹¤.
